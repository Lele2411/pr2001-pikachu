<h2><%= @tour.name %></h2>

<div id="demo" class="carousel slide" data-ride="carousel">
	<!-- Indicators -->
  <ul class="carousel-indicators">
  	<% @images.count.times do |n| %>
    <li data-target="#demo" data-slide-to="<%=n+1%>" class="<%= n == 0 ? 'active' : '' %>"></li>
    <%end%>
  </ul>
	<!-- The slideshow -->
  <div class="carousel-inner">
		<%= render @images, tour: @tour %>
	</div>
  <!-- Left and right controls -->
  <a class="carousel-control-prev" href="#demo" data-slide="prev">
    <span class="carousel-control-prev-icon"></span>
  </a>
  <a class="carousel-control-next" href="#demo" data-slide="next">
    <span class="carousel-control-next-icon"></span>
  </a>

</div>
<div><strong>Description:</strong> <%= @tour.description %></div>
<div><strong>Price($):</strong> <%= @tour.price %></div>
<div><strong>Coupon(%):</strong> <%= @tour.coupon %></div>
<div><strong>You will have a lot of choices about departure time - return time:</strong></div>

<table class="table table-bordered">
	<thead>
		<tr>
			<th>STT</th>
			<th>Departure Time</th>
			<th>Return Time</th>
			<th>Available Seat(s)</th>
			<th>Your choice</th>
		</tr>
	</thead>
	<body>
		<% @tour_details.each_with_index do |tour_detail,i| %>
			<% c = tour_detail.booking_tours&.map{|x| x.quantity}%>
			<tr>
				<td><%=i+1%></td> 
				<td><%= tour_detail.departure_time %></td>
				<td><%= tour_detail.return_time %></td>
				<td><%= @tour.seats - c&.reduce{|sum,x| sum+x}.to_i%></td>
				<% if current_user&&current_user.booking_tours.pluck(:tour_detail_id).include?(tour_detail.id)%>
				<td><%= render 'users/cancel_form', tour: @tour, booking_tour: @booking_tour%></td>
				<%else%>
				<td><%= render 'users/booking_form', tour: @tour, booking_tour: @booking_tour, tour_detail: tour_detail %></td>
				<%end%>
			</tr>
		<% end %>
	</body>
</table>

